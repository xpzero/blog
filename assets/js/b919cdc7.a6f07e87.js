"use strict";(self.webpackChunkblog_2=self.webpackChunkblog_2||[]).push([[5317],{49613:(e,n,t)=>{t.d(n,{Zo:()=>o,kt:()=>h});var a=t(59496);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},o=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,o=c(e,["components","mdxType","originalType","parentName"]),m=p(t),d=r,h=m["".concat(s,".").concat(d)]||m[d]||u[d]||i;return t?a.createElement(h,l(l({ref:n},o),{},{components:t})):a.createElement(h,l({ref:n},o))}));function h(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,l=new Array(i);l[0]=d;var c={};for(var s in n)hasOwnProperty.call(n,s)&&(c[s]=n[s]);c.originalType=e,c[m]="string"==typeof e?e:r,l[1]=c;for(var p=2;p<i;p++)l[p]=t[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},69409:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>c,toc:()=>p});var a=t(47622),r=(t(59496),t(49613));const i={title:"canvas\u5b9e\u73b0\u7c92\u5b50\u80cc\u666f\u7279\u6548\u601d\u8def\u603b\u7ed3",toc_max_heading_level:6,tags:["canvas"]},l=void 0,c={permalink:"/blog/index/2022/01/06/canvas-particle-background",source:"@site/blog/2022/01/06/canvas-particle-background.md",title:"canvas\u5b9e\u73b0\u7c92\u5b50\u80cc\u666f\u7279\u6548\u601d\u8def\u603b\u7ed3",description:"\u6548\u679c",date:"2022-01-06T00:00:00.000Z",formattedDate:"2022\u5e741\u67086\u65e5",tags:[{label:"canvas",permalink:"/blog/index/tags/canvas"}],readingTime:6.445,hasTruncateMarker:!0,authors:[],frontMatter:{title:"canvas\u5b9e\u73b0\u7c92\u5b50\u80cc\u666f\u7279\u6548\u601d\u8def\u603b\u7ed3",toc_max_heading_level:6,tags:["canvas"]},prevItem:{title:"yarn\u5e38\u7528\u547d\u4ee4\u8bb0\u5f55",permalink:"/blog/index/2022/01/09/yarn-command-common"},nextItem:{title:"canvas\u5b9e\u73b0\u5c0f\u7403\u78b0\u649e\u8bb0\u5f55--\u6e90\u7801\u8f6c\u53d1",permalink:"/blog/index/2022/01/05/canvas-ball-collision"}},s={authorsImageUrls:[]},p=[{value:"\u6548\u679c",id:"\u6548\u679c",level:2},{value:"\u6e90\u7801",id:"\u6e90\u7801",level:2},{value:"html",id:"html",level:3},{value:"\u7c92\u5b50\u80cc\u666f.js",id:"\u7c92\u5b50\u80cc\u666fjs",level:3},{value:"\u4e3b\u8981\u601d\u8def",id:"\u4e3b\u8981\u601d\u8def",level:2},{value:"\u73b0\u8c61",id:"\u73b0\u8c61",level:3},{value:"\u601d\u8def\u68b3\u7406",id:"\u601d\u8def\u68b3\u7406",level:3},{value:"\u53c2\u8003",id:"\u53c2\u8003",level:2}],o={toc:p},m="wrapper";function u(e){let{components:n,...i}=e;return(0,r.kt)(m,(0,a.Z)({},o,i,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"\u6548\u679c"},"\u6548\u679c"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"final",src:t(76775).Z,width:"1717",height:"1063"})),(0,r.kt)("h2",{id:"\u6e90\u7801"},"\u6e90\u7801"),(0,r.kt)("h3",{id:"html"},"html"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"\u70b9\u51fb\u67e5\u770b\u4ee3\u7801"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<!doctype html>\n<html lang="en">\n  <head>\n    <meta charset="UTF-8" />\n    <meta http-equiv="X-UA-Compatible" content="IE=edge" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <title>\u7c92\u5b50\u80cc\u666f</title>\n    <style>\n      canvas {\n        margin: 50px auto;\n        display: block;\n        box-shadow: 0 0 10px rgb(0 0 0 / 50%);\n      }\n    </style>\n  </head>\n  <body>\n    <canvas width="800" height="500"></canvas>\n\n    <script src="./js/\u7c92\u5b50\u80cc\u666f.js"><\/script>\n    <script>\n      // \u7c92\u5b50\u96c6\u5408\n      let particles = [];\n      // \u7c92\u5b50\u6570\u91cf\n      const particleCount = 150;\n      // \u9f20\u6807\u4f4d\u7f6e\u5bf9\u8c61\n      let mouseOffset = null;\n      // \u7c92\u5b50\u753b\u7ebf\u7684\u6700\u5c0f\u8ddd\u79bb\n      const minDistance = 100;\n      // \u8fb9\u754c\u78b0\u649e\u68c0\u6d4b\n      const collideDetect = true;\n      // \u662f\u5426\u6709\u9f20\u6807\u4ea4\u4e92\n      const hasInteractMouse = true;\n      const canvas = document.querySelector("canvas");\n      const ctx = canvas.getContext("2d");\n      createParticles();\n      draw();\n      handleCanvasEvent();\n      function draw() {\n        // \u6e05\u7a7a\u753b\u5e03\n        canvas.width = canvas.width;\n        drawParticles(ctx);\n        ctx.lineWidth = 0.1;\n        drawLines(ctx);\n\n        requestAnimationFrame(draw);\n      }\n\n      // \u521b\u5efa\u7c92\u5b50\u5bf9\u8c61\n      function createParticles() {\n        for (let index = 0; index < particleCount; index++) {\n          particles.push(\n            new Particle(\n              getRandomRange(0, canvas.width, canvas.height),\n              getRandomRange(0, canvas.height),\n            ),\n          );\n        }\n      }\n\n      // \u5c06\u7c92\u5b50\u5bf9\u8c61\u753b\u5230\u753b\u5e03\u4e0a\n      function drawParticles(ctx) {\n        ctx.beginPath();\n        for (let index = 0; index < particles.length; index++) {\n          const particle = particles[index];\n\n          particle.draw(ctx);\n\n          // \u6ca1\u6709\u5f00\u542f\u8fb9\u754c\u78b0\u649e\u68c0\u6d4b\uff0c\u8d8a\u754c\u7684\u7c92\u5b50,\u66f4\u65b0\u4f4d\u7f6e\u5e76\u4fdd\u8bc1\u5176\u65b0\u4f4d\u7f6e\u4e0d\u8d8a\u754c\n          if (!collideDetect) {\n            if (\n              particle.x > canvas.width ||\n              particle.x < 0 ||\n              particle.y > canvas.height ||\n              particle.y < 0\n            ) {\n              // \u7c92\u5b50\u76f4\u5f84\n              const diameter = particle.radius * 2;\n              particle.updateCoordinate(\n                getRandomRange(diameter, canvas.width - diameter),\n                getRandomRange(diameter, canvas.height - diameter),\n              );\n            }\n          } else {\n            handleCollide(particle);\n          }\n\n          particle.x += particle.speedX;\n          particle.y += particle.speedY;\n        }\n        ctx.fill();\n      }\n\n      // \u7ed8\u5236\u7c92\u5b50\u8fde\u7ebf\n      function drawLines(ctx) {\n        ctx.beginPath();\n        let arr = [...particles];\n        mouseOffset && (arr = [mouseOffset].concat(arr));\n        for (let index = 0; index < particles.length; index++) {\n          const particle = particles[index];\n\n          for (let j = arr.length - 1; j >= 0; j--) {\n            const particle2 = arr[j];\n            if (particle === particle2) {\n              continue;\n            }\n            const distance = calDistance(\n              particle.x,\n              particle2.x,\n              particle.y,\n              particle2.y,\n            );\n            if (distance < minDistance) {\n              // \u5982\u679c\u662f\u9f20\u6807\uff0c\u5219\u8ba9\u7c92\u5b50\u5411\u9f20\u6807\u7684\u4f4d\u7f6e\u79fb\u52a8,\u8ddd\u79bb-10 \u4fdd\u8bc1\u7c92\u5b50\u4e0e\u9f20\u6807\u4e4b\u95f4\u7684\u6700\u5c0f\u95f4\u8ddd\n              if (particle2 === mouseOffset && distance > minDistance - 10) {\n                const xc = particle.x - particle2.x;\n                const yc = particle.y - particle2.y;\n\n                // 0.03 \u5411\u9f20\u6807\u5750\u6807\u79fb\u52a8\u7684\u901f\u7387\n                particle.x -= xc * 0.03;\n                particle.y -= yc * 0.03;\n              }\n              ctx.moveTo(particle.x, particle.y);\n              ctx.lineTo(particle2.x, particle2.y);\n            }\n          }\n\n          // \u53bb\u6389\u91cd\u590d\u6bd4\u8f83\n          arr.splice(arr.indexOf(particle), 1);\n        }\n\n        ctx.stroke();\n      }\n\n      // \u7c92\u5b50\u8fb9\u754c\u78b0\u649e\u68c0\u6d4b\n      function handleCollide(particle) {\n        if (\n          (particle.speedX && particle.x + particle.radius > canvas.width) ||\n          (particle.speedX < 0 && particle.x < particle.radius)\n        ) {\n          particle.speedX *= -1;\n        }\n        if (\n          (particle.speedY > 0 &&\n            particle.y + particle.radius >= canvas.height) ||\n          (particle.speedY < 0 && particle.y <= particle.radius)\n        ) {\n          particle.speedY *= -1;\n        }\n      }\n\n      // \u5904\u7406canvas\u7684\u4e8b\u4ef6\n      function handleCanvasEvent() {\n        if (hasInteractMouse) {\n          canvas.onmousemove = function (e) {\n            if (!mouseOffset) {\n              mouseOffset = {};\n            }\n            mouseOffset.x = e.offsetX;\n            mouseOffset.y = e.offsetY;\n          };\n        }\n      }\n\n      function calDistance(x1, x2, y1, y2) {\n        return Math.hypot(x1 - x2, y1 - y2);\n      }\n\n      function getRandomRange(min, max) {\n        return Math.random() * (max - min) + min;\n      }\n    <\/script>\n  </body>\n</html>\n'))),(0,r.kt)("h3",{id:"\u7c92\u5b50\u80cc\u666fjs"},"\u7c92\u5b50\u80cc\u666f.js"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"\u70b9\u51fb\u67e5\u770b\u4ee3\u7801"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"class Particle {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n    this.radius = 0.5;\n    this.speedX = this._getRandomRange(-1, 1);\n    this.speedY = this._getRandomRange(-1, 1);\n  }\n\n  draw(ctx) {\n    ctx.moveTo(this.x, this.y);\n    ctx.arc(this.x, this.y, this.radius, 0, 2 * Math.PI);\n  }\n\n  updateCoordinate(x, y) {\n    this.x = x;\n    this.y = y;\n    return this;\n  }\n\n  _getRandomRange(min, max) {\n    return Math.random() * (max - min) + min;\n  }\n}\n"))),(0,r.kt)("h2",{id:"\u4e3b\u8981\u601d\u8def"},"\u4e3b\u8981\u601d\u8def"),(0,r.kt)("h3",{id:"\u73b0\u8c61"},"\u73b0\u8c61"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u7c92\u5b50\u4e4b\u95f4\u3001\u9f20\u6807\u4e0e\u7c92\u5b50\u4e4b\u95f4\uff0c\u5c0f\u4e8e\u4e00\u5b9a\u7684\u503c\u4f1a\u8fde\u7ebf"),(0,r.kt)("li",{parentName:"ul"},"\u7c92\u5b50\u7684\u79fb\u52a8\u662f\u968f\u673a\u7684"),(0,r.kt)("li",{parentName:"ul"},"\u7c92\u5b50\u5411\u9f20\u6807\u79fb\u52a8\u65f6\uff0c\u6709\u4e00\u4e2a\u52a0\u901f\u7684\u8fc7\u7a0b")),(0,r.kt)("h3",{id:"\u601d\u8def\u68b3\u7406"},"\u601d\u8def\u68b3\u7406"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u62bd\u8c61\u5706\u5f62\u7c92\u5b50\u7c7b"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5750\u6807\uff0cx,y\u3002\u7531\u5916\u90e8\u4f20\u5165"),(0,r.kt)("li",{parentName:"ul"},"\u79fb\u901f\uff0cx,y\u3002\u81ea\u5df1\u5185\u90e8\u968f\u673a\u5b9a\u4e49"),(0,r.kt)("li",{parentName:"ul"},"\u534a\u5f84\u3002\u5185\u90e8\u5b9a\u4e49"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u51c6\u5907\u7c92\u5b50\uff0c\u753b\u5e03\u4e0a\u4e00\u76f4\u53ea\u6709\u5b9a\u91cf\u7684\u7c92\u5b50"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u4e00\u4e2a\u6570\u7ec4\uff0c\u627f\u8f7d\u521b\u5efa\u7684\u5b9a\u91cf\u7684\u7c92\u5b50"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u753b\u5e03\u6709\u9f20\u6807\u79fb\u52a8\u4e8b\u4ef6\u7684\u76d1\u542c"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u50a8\u5b58\u9f20\u6807\u7684\u4f4d\u7f6e\uff0c\u7528\u6765\u5224\u65ad\u7c92\u5b50\u4e0e\u9f20\u6807\u4f4d\u7f6e\u95f4\u662f\u5426\u5e94\u8be5\u8fde\u7ebf"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u6279\u91cf\u7ed8\u5236\u7c92\u5b50"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u7ed8\u5236\u7c92\u5b50\u65f6\u5bf9\u7c92\u5b50\u8fdb\u884c\u8fb9\u754c\u78b0\u649e\u68c0\u6d4b\u3002\u6216\u8005\u5230\u8fb9\u754c\u540e\u66f4\u65b0\u7c92\u5b50\u7684\u4f4d\u7f6e\uff08\u786e\u4fdd\u5176\u4e0d\u8d8a\u754c\uff09"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u6279\u91cf\u7ed8\u5236\u7c92\u5b50\u95f4\u3001\u9f20\u6807\u548c\u7c92\u5b50\u95f4\u7684\u8fde\u7ebf"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5982\u679c\u7c92\u5b50\u95f4\u7684\u7403\u5fc3\u8ddd\u79bb\u5c0f\u4e8e\u9650\u5b9a\u7684\u8fde\u7ebf\u8ddd\u79bb\uff0c\u5219\u5728\u8fd9\u4e24\u4e2a\u7c92\u5b50\u4e2d\u95f4\u8fde\u7ebf")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5982\u679c\u7c92\u5b50\u548c\u9f20\u6807\u7684\u8ddd\u79bb\u5c0f\u4e8e\u9650\u5b9a\u7684\u8fde\u7ebf\u8ddd\u79bb\uff0c\u5219\u5728\u9f20\u6807\u548c\u7c92\u5b50\u4e2d\u95f4\u8fde\u7ebf"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u8fde\u7ebf\u524d\uff0c\u5982\u679c\u7c92\u5b50\u4e0e\u9f20\u6807\u4f4d\u7f6e\u95f4\u7684\u8ddd\u79bb\u5c0f\u4e8e\u4e00\u5b9a\u95f4\u8ddd\uff0c\u7c92\u5b50\u5411\u9f20\u6807\u4f4d\u7f6e\u79fb\u52a8\uff08\u6709\u4e00\u4e2a\u7c92\u5b50\u56f4\u7ed5\u7740\u9f20\u6807\u7684\u6548\u679c\uff09")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u79fb\u52a8\u7684\u8ddd\u79bb\uff0c\u6709\u6b63\u3001\u8d1f\u3002\u7528\u9f20\u6807\u7684\u5750\u6807\u548c\u7c92\u5b50\u7684\u5750\u6807\u505a\u5bf9\u5e94\u65b9\u5411\u4e0a\u7684\u52a0\u51cf\u8fd0\u7b97\uff0c\u518d\u4e58\u4ee5\u4e00\u4e2a\u503c\uff08\u8868\u793a\u79fb\u52a8\u901f\u7387\uff0c\u4f53\u73b0\u5728\u7c92\u5b50\u5411\u9f20\u6807\u79fb\u52a8\u7684\u6548\u679c\u4e0a\uff09")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u8ba1\u7b97\u793a\u4f8b",(0,r.kt)("span",{style:{color:"red",fontWeight:700}},"\u5b9e\u73b0\u9f20\u6807\u4ea4\u4e92\u7684\u91cd\u70b9")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// \u5982\u679c\u7c92\u5b50\u672c\u5c31\u5728\u9f20\u6807\u9644\u8fd1\uff0c\u4e0d\u7528\u518d\u505a\u79fb\u52a8(\u4e00\u5b9a\u95f4\u8ddd\u7684\u9650\u5236\uff0c\u6709\u4e00\u4e2a\u7c92\u5b50\u56f4\u7ed5\u9f20\u6807\u4f46\u4e0d\u6328\u7740\u9f20\u6807\u7684\u6548\u679c)\nif (\n  \u7c92\u5b50\u4e0e\u9f20\u6807\u95f4\u7684\u8ddd\u79bb < \u8fde\u7ebf\u9650\u5b9a\u8ddd\u79bb &&\n  \u7c92\u5b50\u4e0e\u9f20\u6807\u95f4\u7684\u8ddd\u79bb > \u4e00\u5b9a\u95f4\u8ddd\n) {\n  // xDistance \u6b63\u8d1f\u4e0d\u5b9a\n  const xDistance = \u7c92\u5b50\u5750\u6807x - \u9f20\u6807\u5750\u6807.x;\n  // yDistance \u6b63\u8d1f\u4e0d\u5b9a\n  const yDistance = \u7c92\u5b50\u5750\u6807y - \u9f20\u6807\u5750\u6807.y;\n\n  const rate = 0.03;\n\n  // \u65e0\u8bbaxDistance\u3001yDistance\u6b63\u8d1f\u5982\u4f55\uff0c\u8fd9\u91cc\u90fd\u8981\u4fdd\u8bc1\u662f\u7c92\u5b50\u5728\u5411\u9f20\u6807\u79fb\u52a8\n  \u7c92\u5b50\u5750\u6807.x -= xDistance * rate;\n  \u7c92\u5b50\u5750\u6807.y -= yDistance * rate;\n}\n")))))))))),(0,r.kt)("h2",{id:"\u53c2\u8003"},"\u53c2\u8003"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://segmentfault.com/a/1190000016209871"},"canvas\u7c92\u5b50\u52a8\u753b\u80cc\u666f")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/axes/p/4960171.html"},"\u7528 canvas \u505a\u4e2a\u597d\u73a9\u7684\u7f51\u7ad9\u80cc\u666f")))}u.isMDXComponent=!0},76775:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/final-b6ac100717e66b949dabd32d514d84f6.gif"}}]);