"use strict";(self.webpackChunkblog_2=self.webpackChunkblog_2||[]).push([[5653],{78633:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>h,contentTitle:()=>r,default:()=>o,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var i=t(11527),s=t(56213);const a={title:"canvas\u70b8\u70df\u82b1\u601d\u8def\u603b\u7ed3",toc_max_heading_level:6,tags:["canvas"]},r=void 0,l={permalink:"/blog/index/2022/01/05/canvas-bomb-fireworks",source:"@site/blog/2022/01/05/canvas-bomb-fireworks.md",title:"canvas\u70b8\u70df\u82b1\u601d\u8def\u603b\u7ed3",description:"\u6548\u679c",date:"2022-01-05T00:00:00.000Z",formattedDate:"2022\u5e741\u67085\u65e5",tags:[{label:"canvas",permalink:"/blog/index/tags/canvas"}],readingTime:6.76,hasTruncateMarker:!0,authors:[],frontMatter:{title:"canvas\u70b8\u70df\u82b1\u601d\u8def\u603b\u7ed3",toc_max_heading_level:6,tags:["canvas"]},unlisted:!1,prevItem:{title:"canvas\u5b9e\u73b0\u5c0f\u7403\u78b0\u649e\u8bb0\u5f55--\u6e90\u7801\u8f6c\u53d1",permalink:"/blog/index/2022/01/05/canvas-ball-collision"},nextItem:{title:"canvas\u5b9e\u73b0\u9f20\u6807\u8ffd\u8e2a\u52a8\u753b\u601d\u8def\u603b\u7ed3",permalink:"/blog/index/2022/01/04/canvas-mouse-trace"}},h={authorsImageUrls:[]},c=[{value:"\u6548\u679c",id:"\u6548\u679c",level:2},{value:"\u6e90\u7801",id:"\u6e90\u7801",level:2},{value:"html",id:"html",level:3},{value:"\u70df\u82b1.js",id:"\u70df\u82b1js",level:3},{value:"\u70df\u82b1\u7c92\u5b50.js",id:"\u70df\u82b1\u7c92\u5b50js",level:3},{value:"\u4e3b\u8981\u6d41\u7a0b",id:"\u4e3b\u8981\u6d41\u7a0b",level:2},{value:"\u70df\u82b1\u53d1\u5c04",id:"\u70df\u82b1\u53d1\u5c04",level:4},{value:"\u7c92\u5b50\u7efd\u653e",id:"\u7c92\u5b50\u7efd\u653e",level:4},{value:"\u8def\u7ebf\u5f62\u6210",id:"\u8def\u7ebf\u5f62\u6210",level:4},{value:"\u62d6\u5c3e\u6548\u679c",id:"\u62d6\u5c3e\u6548\u679c",level:4}];function d(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...n.components},{Details:a}=e;return a||function(n,e){throw new Error("Expected "+(e?"component":"object")+" `"+n+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h2,{id:"\u6548\u679c",children:"\u6548\u679c"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"final",src:t(93372).Z+"",width:"1708",height:"1059"})}),"\n",(0,i.jsx)(e.h2,{id:"\u6e90\u7801",children:"\u6e90\u7801"}),"\n",(0,i.jsx)(e.h3,{id:"html",children:"html"}),"\n",(0,i.jsxs)(a,{children:[(0,i.jsx)("summary",{children:"\u70b9\u51fb\u67e5\u770b\u4ee3\u7801"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-html",children:'<!doctype html>\n<html lang="en">\n  <head>\n    <meta charset="UTF-8" />\n    <meta http-equiv="X-UA-Compatible" content="IE=edge" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <title>\u70df\u82b1\u6548\u679c</title>\n    <style>\n      canvas {\n        margin: 80px auto;\n        display: block;\n        box-shadow: 0 0 10px rgb(0 0 0 / 50%);\n      }\n    </style>\n  </head>\n  <body onload="draw()">\n    <canvas width="800" height="500"></canvas>\n\n    <script src="./js/\u70df\u82b1.js"><\/script>\n    <script src="./js/\u70df\u82b1\u7c92\u5b50.js"><\/script>\n    <script>\n      let timeTicker = 0;\n      // \u52a8\u753b\u6267\u884c80\u6b21\uff0c\u53d1\u5c048\u4e2a\u70df\u82b1\n      let timeTotal = 80;\n      let fireworks = [];\n      // \u4e00\u4e2a\u70df\u82b1\u6709\u591a\u5c11\u4e2a\u7c92\u5b50\n      const particlesCount = 50;\n      let particles = [];\n      function draw() {\n        const canvas = document.querySelector("canvas");\n        const ctx = canvas.getContext("2d");\n        // \u900f\u660e\u5ea6\u63a7\u5236\u62d6\u5c3e\u6548\u679c\n        ctx.fillStyle = "rgba(0,0,0,0.03)";\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n        // \u753b\u70df\u82b1\n        for (let index = 0; index < fireworks.length; index++) {\n          const firework = fireworks[index];\n          firework.draw(ctx);\n          if (firework.isArrived()) {\n            fireworks.splice(index, 1);\n            index--;\n            for (let j = 0; j < particlesCount; j++) {\n              particles.push(\n                new Particle(\n                  ...firework.getTargetCoordinate(),\n                  firework.getHue(),\n                ),\n              );\n            }\n          }\n        }\n\n        // \u753b\u7c92\u5b50\n        for (let index = 0; index < particles.length; index++) {\n          const particle = particles[index];\n          particle.draw(ctx);\n          if (particle.isVanished()) {\n            particles.splice(index, 1);\n            index--;\n          }\n        }\n\n        // \u51fd\u6570\u5faa\u73af80\u6b21\u81ea\u52a8\u53d1\u5c048\u652f\u70df\u82b1\n        if (timeTicker >= timeTotal) {\n          for (let index = 0; index < timeTotal / 10; index++) {\n            fireworks.push(\n              new FireWork(\n                canvas.width / 2,\n                canvas.height,\n                getRandomRange(0, canvas.width),\n                getRandomRange(100, canvas.height / 2),\n              ),\n            );\n          }\n          timeTicker = 0;\n        } else {\n          timeTicker++;\n        }\n\n        requestAnimationFrame(draw);\n      }\n\n      function getRandomRange(min, max) {\n        return Math.random() * (max - min) + min;\n      }\n    <\/script>\n  </body>\n</html>\n'})})]}),"\n",(0,i.jsx)(e.h3,{id:"\u70df\u82b1js",children:"\u70df\u82b1.js"}),"\n",(0,i.jsxs)(a,{children:[(0,i.jsx)("summary",{children:"\u70b9\u51fb\u67e5\u770b\u4ee3\u7801"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"class FireWork {\n  constructor(startX, startY, endX, endY) {\n    // \u70df\u82b1\u8d77\u59cb\u70b9(\u4ece\u54ea\u4e2a\u5730\u65b9\u5f00\u59cb\u53d1\u5c04)\n    this.startX = startX;\n    this.startY = startY;\n\n    // \u5f53\u524d\u5750\u6807(\u70df\u82b1\u79fb\u52a8\u8fc7\u7a0b\u4e2d\u4f7f\u7528)\n    this.x = this.startX;\n    this.y = this.startY;\n\n    // \u70df\u82b1\u7ed3\u675f\u70b9(\u53d1\u5c04\u5230\u54ea\u4e2a\u5730\u65b9)\n    this.endX = endX;\n    this.endY = endY;\n\n    // \u76ee\u6807\u8ddd\u79bb\n    this.targetDistance = this._getPointsDistance(\n      this.startX,\n      this.startY,\n      this.endX,\n      this.endY,\n    );\n\n    // \u5f53\u524d\u70df\u82b1\u79fb\u52a8\u7684\u8ddd\u79bb\n    this.currentDistance = 0;\n\n    // hsla \u8272\u8c03\n    this.hue = this._getRandomRange(0, 360);\n    // hsla \u4eae\u5ea6\n    this.lightness = this._getRandomRange(50, 70);\n\n    // \u88ab\u53d1\u5c04\u7684\u89d2\u5ea6(\u6839\u636e\u7ed9\u5b9a\u7684\u5f00\u59cb\u3001\u7ed3\u675f\u4f4d\u7f6e\u8ba1\u7b97\u89d2\u5ea6)\n    this.angle = Math.atan2(this.endY - this.startY, this.endX - this.startX);\n\n    // \u79fb\u52a8\u901f\u5ea6\n    this.speed = 2;\n    this.acceleration = 1.05; // \u52a0\u901f\u5ea6\u7cfb\u6570\n  }\n\n  draw(ctx) {\n    ctx.save();\n    this.speed *= this.acceleration;\n    const moveX = this.x + Math.cos(this.angle) * this.speed;\n    const moveY = this.y + Math.sin(this.angle) * this.speed;\n    ctx.strokeStyle = `hsla(${this.hue}, 100%, ${this.lightness}%, 60%)`; // \u4ec5\u4eae\u5ea6\u4f1a\u53d8\u5316\n    ctx.lineWidth = 1;\n    ctx.beginPath();\n    ctx.moveTo(this.x, this.y);\n    ctx.lineTo(moveX, moveY);\n    ctx.stroke();\n    ctx.restore();\n\n    this.currentDistance = this._getPointsDistance(\n      this.startX,\n      this.startY,\n      moveX,\n      moveY,\n    );\n\n    this.x = moveX;\n    this.y = moveY;\n  }\n\n  // \u662f\u5426\u5230\u8fbe\u76ee\u6807\u5730\u70b9\n  isArrived() {\n    return this.currentDistance >= this.targetDistance;\n  }\n\n  // \u83b7\u53d6\u70df\u82b1\u8272\u8c03\n  getHue() {\n    return this.hue;\n  }\n\n  // \u83b7\u53d6\u76ee\u6807\u4f4d\u7f6e\u7684\u5750\u6807\n  getTargetCoordinate() {\n    return [this.endX, this.endY];\n  }\n\n  _getRandomRange(min, max) {\n    return Math.random() * (max - min) + min;\n  }\n\n  // \u8ba1\u7b97\u76f4\u89d2\uff08\u7b1b\u5361\u5c14\uff09\u5750\u6807\u7cfb\u4e2d\u4e24\u70b9\u95f4\u8ddd\u79bb\n  _getPointsDistance(x1, y1, x2, y2) {\n    return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\n  }\n}\n"})})]}),"\n",(0,i.jsx)(e.h3,{id:"\u70df\u82b1\u7c92\u5b50js",children:"\u70df\u82b1\u7c92\u5b50.js"}),"\n",(0,i.jsxs)(a,{children:[(0,i.jsx)("summary",{children:"\u70b9\u51fb\u67e5\u770b\u4ee3\u7801"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:'class Particle {\n  constructor(x, y, hue) {\n    // \u521d\u59cb\u4f4d\u7f6e\n    this.x = x;\n    this.y = y;\n\n    // \u4ece\u70df\u82b1\u90a3\u5f97\u6765\u7684hsla\u8272\u8c03\n    this.hue = this._getRandomRange(hue - 20, hue + 20);\n    //this.hue = hue\n    // \u968f\u673ahsla\u4eae\u5ea6\n    this.lightness = this._getRandomRange(50, 80);\n\n    // \u521d\u59cb\u900f\u660e\u5ea6\n    this.alpha = 1;\n    // \u968f\u673a\u7684\u900f\u660e\u5ea6\u8870\u53d8\u7cfb\u6570\uff08\u900f\u660e\u5ea6\u51cf\u6de1\uff09\n    this.alphaDecay = this._getRandomRange(0.015, 0.03);\n\n    // \u6a21\u62df\u4e0b\u5760\u6469\u64e6\u529b(\u8ba9\u7c92\u5b50\u51cf\u901f)\n    this.friction = 0.95;\n    // \u6a21\u62df\u91cd\u529b\u52a0\u901f\u5ea6\n    this.gravity = 1;\n\n    // \u968f\u673a\u89d2\u5ea6\n    this.angle = this._getRandomRange(0, 2 * Math.PI);\n    // \u968f\u673a\u521d\u59cb\u901f\u5ea6\n    this.speed = this._getRandomRange(1, 10);\n  }\n\n  draw(ctx) {\n    ctx.save();\n    // \u51cf\u901f\n    this.speed *= this.friction;\n    // \u8ba1\u7b97\u65b0\u4f4d\u7f6e\n    const moveX = this.x + Math.cos(this.angle) * this.speed;\n    const moveY = this.y + Math.sin(this.angle) * this.speed + this.gravity;\n\n    ctx.beginPath();\n    ctx.moveTo(this.x, this.y);\n    ctx.lineTo(moveX, moveY);\n\n    ctx.strokeStyle = `hsla(${this.hue}, 100%, ${this.lightness}%, ${this.alpha})`;\n    ctx.lineWidth = 3;\n    ctx.lineCap = "round";\n    ctx.stroke();\n    ctx.restore();\n    this.x = moveX;\n    this.y = moveY;\n    // \u900f\u660e\u5ea6\u8870\u51cf\n    this.alpha -= this.alphaDecay;\n  }\n\n  _getRandomRange(min, max) {\n    return Math.random() * (max - min) + min;\n  }\n\n  // \u7c92\u5b50\u662f\u5426\u5df2\u7ecf\u770b\u4e0d\u89c1\n  isVanished() {\n    return this.alpha < this.alphaDecay;\n  }\n}\n'})})]}),"\n",(0,i.jsx)(e.h2,{id:"\u4e3b\u8981\u6d41\u7a0b",children:"\u4e3b\u8981\u6d41\u7a0b"}),"\n",(0,i.jsx)(e.p,{children:"\u70df\u82b1\u88ab\u53d1\u5c04\u5230\u6307\u5b9a\u4f4d\u7f6e\u540e\u6d88\u5931\uff0c\u7c92\u5b50\u7efd\u653e\uff0c\u5b9e\u73b0\u70df\u82b1\u7efd\u653e\u7684\u6548\u679c"}),"\n",(0,i.jsx)(e.h4,{id:"\u70df\u82b1\u53d1\u5c04",children:"\u70df\u82b1\u53d1\u5c04"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u70df\u82b1\u5c04\u901f\u63a7\u5236\uff0c\u52a8\u753b\u6267\u884c80\u6b21\u540e\uff0c\u53d1\u5c048\u4e2a\u70df\u82b1\uff08\u63a7\u5236\u53d1\u5c04\u9891\u7387\uff09"}),"\n",(0,i.jsxs)(e.li,{children:["\u70df\u82b1\u53d1\u5c04\u524d\uff0c\u5176\u89d2\u5ea6\u3001\u989c\u8272\u3001\u76ee\u6807\u4f4d\u7f6e\u5747\u5df2\u786e\u5b9a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u89d2\u5ea6\u3001\u989c\u8272\u3001\u76ee\u6807\u4f4d\u7f6e\u90fd\u662f\u968f\u673a\u7684"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u70df\u82b1\u53d1\u5c04\u65f6\u6709\u521d\u59cb\u901f\u5ea6\u548c\u52a0\u901f\u5ea6(\u8868\u73b0\u5728\u70df\u82b1\u6d88\u5931\u65f6\u523b\u7684\u90a3\u4e2a\u51b2\u52b2\u513f)"}),"\n",(0,i.jsx)(e.li,{children:"\u70df\u82b1\u5230\u8fbe\u76ee\u6807\u4f4d\u7f6e\u540e\u6d88\u5931\uff0c\u7efd\u653e\u7c92\u5b50"}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"\u7c92\u5b50\u7efd\u653e",children:"\u7c92\u5b50\u7efd\u653e"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u6bcf\u4e2a\u7c92\u5b50\u7efd\u653e\u65f6\uff0c\u521d\u59cb\u4f4d\u7f6e\u3001\u901f\u5ea6\u3001\u89d2\u5ea6\u3001\u989c\u8272\u5747\u5df2\u786e\u5b9a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u521d\u59cb\u4f4d\u7f6e\uff1a\u70df\u82b1\u7684\u7ed3\u675f\u4f4d\u7f6e"}),"\n",(0,i.jsx)(e.li,{children:"\u901f\u5ea6\uff1a\u521d\u59cb\u662f\u968f\u673a\u7684\u3002\u79fb\u52a8\u8fc7\u7a0b\u4e2d\u6a21\u62df\u6469\u64e6\u529b/\u963b\u529b\uff0c\u901f\u5ea6\u9010\u6e10\u51cf\u5c0f"}),"\n",(0,i.jsx)(e.li,{children:"\u89d2\u5ea6\uff1a\u968f\u673a\u3002\u751f\u6210\u540e\u4e0d\u518d\u53d1\u751f\u53d8\u5316"}),"\n",(0,i.jsx)(e.li,{children:"\u989c\u8272\uff1a\u70df\u82b1\u7684\u989c\u8272\u3002\u53ef\u4ee5\u56f4\u7ed5\u70df\u82b1\u7684\u989c\u8272\u6709\u4e9b\u8bb8\u53d8\u5316\uff0c\u5448\u73b0\u4e94\u989c\u516d\u8272\u7684\u6548\u679c"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u4e3a\u6a21\u62df\u7269\u4f53\u4e0b\u5760\uff0c\u7c92\u5b50\u79fb\u52a8\u8fc7\u7a0b\u4e2d\u9700\u8981\u6709\u6a21\u62df\u7684\u6469\u64e6\u529b\uff08\u7c92\u5b50\u79fb\u901f\u51cf\u5c0f\uff09\u3001\u91cd\u529b\u52a0\u901f\u5ea6\uff08\u6a21\u62df\u7c92\u5b50\u6709\u91cd\u529b\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u7c92\u5b50\u79fb\u52a8\u8fc7\u7a0b\u4e2d\uff0c\u989c\u8272\u9010\u6e10\u900f\u660e\uff08\u8868\u793a\u7c92\u5b50/\u70df\u82b1\u6d88\u5931\uff09\u3002\u4f4e\u4e8e\u4e00\u5b9a\u7684\u900f\u660e\u5ea6\u65f6\uff0c\u7c92\u5b50\u6d88\u5931"}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"\u8def\u7ebf\u5f62\u6210",children:"\u8def\u7ebf\u5f62\u6210"}),"\n",(0,i.jsx)(e.p,{children:"\u70df\u82b1\u548c\u7c92\u5b50\u7684\u79fb\u52a8\u8def\u7ebf\u8ba1\u7b97\u90fd\u7b26\u5408\u4e0b\u9762\u7684\u6d41\u7a0b"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u521d\u59cb\u4f4d\u7f6e\u968f\u673a"}),"\n",(0,i.jsx)(e.li,{children:"\u79fb\u52a8\u8fc7\u7a0b\u4e2d\uff0c\u968f\u7740\u901f\u5ea6\u53d1\u751f\u53d8\u5316\uff0c\u6839\u636e\u89d2\u5ea6\u8ba1\u7b97\u79fb\u52a8\u7684\u5750\u6807"}),"\n",(0,i.jsxs)(e.li,{children:["\u7528\u4e0a\u4e00\u6b21\u7684\u7ed3\u675f\u5750\u6807\u4f5c\u4e3a\u8fd9\u4e00\u6b21\u7684\u5f00\u59cb\u5750\u6807\uff0c\u5e76\u91cd\u65b0\u6839\u636e\u901f\u5ea6\u3001\u89d2\u5ea6\uff08\u56e0\u4e3a\u8981\u6cbf\u7740\u540c\u4e00\u4e2a\u65b9\u5411\u8d70\uff09\u8ba1\u7b97\u8981\u79fb\u52a8\u7684\u5750\u6807\u8ddd\u79bb\uff08\u5750\u6807\u53d8\u5316\u91cf\uff09","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u65b0\u5750\u6807=\u65e7\u5750\u6807+\u5750\u6807\u53d8\u5316\u91cf"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"\u62d6\u5c3e\u6548\u679c",children:"\u62d6\u5c3e\u6548\u679c"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"fillStyle"}),"\u7684\u900f\u660e\u5ea6\u63a7\u5236\u62d6\u5c3e\u6548\u679c\uff0c\u8d8a\u900f\u660e\uff0c\u62d6\u5c3e\u8d8a\u660e\u663e"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"tail",src:t(73811).Z+"",width:"1178",height:"254"})}),"\n",(0,i.jsx)(e.h1,{id:"\u53c2\u8003",children:"\u53c2\u8003"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.a,{href:"https://juejin.cn/post/6950544215549935623",children:"Canvas\u653e\u70df\u82b1"})})]})}function o(n={}){const{wrapper:e}={...(0,s.a)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},93372:(n,e,t)=>{t.d(e,{Z:()=>i});const i=t.p+"assets/images/final-7f678f3e9e917c0372aba5555b2d7243.png"},73811:(n,e,t)=>{t.d(e,{Z:()=>i});const i=t.p+"assets/images/tail-d83f3c9b0d684211b855d89db4b9cdbd.png"},56213:(n,e,t)=>{t.d(e,{Z:()=>l,a:()=>r});var i=t(50959);const s={},a=i.createContext(s);function r(n){const e=i.useContext(a);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:r(n.components),i.createElement(a.Provider,{value:e},n.children)}}}]);